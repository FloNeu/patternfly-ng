{"version":3,"file":"list-view.component.js","sourceRoot":"","sources":["../../../../src/app/list-view/list-view.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  EventEmitter,\n  Input,\n  OnInit,\n  Output,\n  TemplateRef,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport { Action } from '../models/action';\nimport { ListViewConfig } from './list-view-config';\nimport { ListViewEvent } from './list-view-event';\n\nimport { cloneDeep, defaults, isEqual, without } from 'lodash';\n\n/**\n * List view component.\n */\n@Component({\n  encapsulation: ViewEncapsulation.None,\n  selector: 'pfng-list-view',\n  styleUrls: ['./list-view.component.less'],\n  templateUrl: './list-view.component.html'\n})\nexport class ListViewComponent implements OnInit {\n  @Input() actionTemplate: TemplateRef<any>;\n  @Input() config: ListViewConfig;\n  @Input() itemExpandedTemplate: TemplateRef<any>;\n  @Input() items: any[];\n  @Input() itemTemplate: TemplateRef<any>;\n\n  @Output('onActionSelect') onActionSelect = new EventEmitter();\n  @Output('onCheckBoxChange') onCheckBoxChange = new EventEmitter();\n  @Output('onClick') onClick = new EventEmitter();\n  @Output('onDblClick') onDblClick = new EventEmitter();\n  @Output('onDragEnd') onDragEnd = new EventEmitter();\n  @Output('onDragMoved') onDragMoved = new EventEmitter();\n  @Output('onDragStart') onDragStart = new EventEmitter();\n  @Output('onSelect') onSelect = new EventEmitter();\n  @Output('onSelectionChange') onSelectionChange = new EventEmitter();\n\n  dragItem: any;\n  itemsEmpty: boolean = true;\n  prevConfig: ListViewConfig;\n\n  defaultConfig = {\n    selectItems: false,\n    multiSelect: false,\n    dblClick: false,\n    dragEnabled: false,\n    selectedItems: [],\n    selectionMatchProp: 'uuid',\n    checkDisabled: false,\n    useExpandingRows: false,\n    showSelectBox: true\n  } as ListViewConfig;\n\n  constructor() {\n  }\n\n  // Initialization\n\n  ngOnInit(): void {\n    this.setupConfig();\n  }\n\n  ngDoCheck(): void {\n    // Do a deep compare on config\n    if (!isEqual(this.config, this.prevConfig)) {\n      this.setupConfig();\n    }\n    this.itemsEmpty = !(this.items !== undefined && this.items.length > 0);\n  }\n\n  setupConfig(): void {\n    if (this.config !== undefined) {\n      defaults(this.config, this.defaultConfig);\n    } else {\n      this.config = cloneDeep(this.defaultConfig);\n    }\n    if ((this.config.multiSelect === undefined || this.config.multiSelect === false)\n        && this.config.selectedItems && this.config.selectedItems.length > 0) {\n      this.config.selectedItems = [this.config.selectedItems[0]];\n    }\n    if (this.config.selectItems && this.config.showSelectBox) {\n      throw new Error('ListViewComponent - Illegal use: ' +\n        'Cannot use both select box and click selection at the same time.');\n    }\n    this.prevConfig = cloneDeep(this.config);\n  }\n\n  // Actions\n\n  handleAction(action: Action): void {\n    if (action && action.disabled !== true) {\n      this.onActionSelect.emit(action);\n    }\n  }\n\n  // Checkbox\n\n  checkBoxChange(item: any): void {\n    this.onCheckBoxChange.emit({\n      item: item\n    } as ListViewEvent);\n  }\n\n  isSelected(item: any): boolean {\n    let matchProp = this.config.selectionMatchProp;\n    let selected = false;\n\n    if (this.config.showSelectBox) {\n      selected = item.selected;\n    } else if (this.config.selectItems !== undefined) {\n      this.config.selectedItems.forEach((itemObj) => {\n        if (itemObj[matchProp] === item[matchProp]) {\n          selected = true;\n        }\n      });\n    }\n    return selected;\n  }\n\n  // Drag and drop\n\n  dragEnd(): void {\n    this.onDragEnd.emit({\n      item: this.dragItem\n    } as ListViewEvent);\n  }\n\n  dragMoved(): void {\n    this.onDragMoved.emit({\n      item: this.dragItem\n    } as ListViewEvent);\n  }\n\n  isDragOriginal(item: any): boolean {\n    return (item === this.dragItem);\n  }\n\n  dragStart(item: any): void {\n    this.dragItem = item;\n    this.onDragStart.emit({\n      item: this.dragItem\n    } as ListViewEvent);\n  }\n\n  // Row Selection\n\n  itemClick($event: MouseEvent, item: any): void {\n    let alreadySelected;\n    let selectionChanged = false;\n\n    // Ignore disabled item clicks completely\n    if (item.disabled === true) {\n      return;\n    }\n\n    if (this.config.selectItems) {\n      if (this.config.multiSelect && !this.config.dblClick) {\n        for (let i = 0; i < this.config.selectedItems.length - 1; i++) {\n          if (this.config.selectedItems[i] === item) {\n            alreadySelected = true;\n            break;\n          }\n        }\n        if (alreadySelected) {\n          // already selected so deselect\n          this.config.selectedItems = without(this.config.selectedItems, item);\n        } else {\n          // add the item to the selected items\n          this.config.selectedItems.push(item);\n          selectionChanged = true;\n        }\n      } else {\n        if (this.config.selectedItems[0] === item) {\n          if (!this.config.dblClick) {\n            this.config.selectedItems = [];\n            selectionChanged = true;\n          }\n        } else {\n          this.config.selectedItems = [item];\n          selectionChanged = true;\n        }\n      }\n\n      if (selectionChanged === true) {\n        this.onSelect.emit({\n          item: item\n        } as ListViewEvent);\n        this.onSelectionChange.emit({\n          item: item,\n          selectedItems: this.config.selectedItems\n        } as ListViewEvent);\n      }\n    }\n    this.onClick.emit({\n      item: item\n    } as ListViewEvent);\n  }\n\n  dblClick($event: MouseEvent, item: any): void {\n    // Ignore disabled item clicks\n    if (this.config.dblClick === true && item.disabled !== true) {\n      this.onDblClick.emit({\n        item: item\n      } as ListViewEvent);\n    }\n  }\n\n  // Toggle\n\n  closeExpandingRow(item: any): void {\n    item.expandingRowId = undefined;\n    item.isRowExpanded = false;\n  }\n\n  toggleExpandingRow(item: any): void {\n    // Row may already be open due to compound expansion\n    if (item.isRowExpanded && item.expandingRowId !== undefined) {\n      item.expandingRowId = undefined;\n      return;\n    }\n    item.expandingRowId = undefined;\n    item.isRowExpanded = !item.isRowExpanded;\n  }\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}